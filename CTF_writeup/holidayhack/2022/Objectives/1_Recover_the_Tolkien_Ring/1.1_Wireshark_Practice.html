<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>1.1 Wireshark Practice - alt3kx KringleCon 2022 Write-Up</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../css/print-site-enum-headings2.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings3.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings4.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings5.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings6.css" rel="stylesheet" />
        <link href="../../css/print-site.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "1.1 Wireshark Practice";
        var mkdocs_page_input_path = "Objectives/1_Recover_the_Tolkien_Ring/1.1_Wireshark_Practice.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../index.html" class="icon icon-home"> alt3kx KringleCon 2022 Write-Up
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">0. KringleCon Orientation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/01_Talk_to_Jingle_Ringford.html">01. Talk to Jingle Ringford</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/02_Get_your_badge.html">02. Get your badge</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/03_Create_a_wallet.html">03. Create a wallet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/04_Use_the_terminal.html">04. Use the terminal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/05_Talk_to_Santa.html">05. Talk to Santa</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">1. Recover the Tolkien Ring</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="1.1_Wireshark_Practice.html">1.1 Wireshark Practice</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#11-wireshark-practice">1.1 Wireshark Practice</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#solve">Solve</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#terminal-answers">Terminal answers</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="1.2_Find_the_Next_Objective.html">1.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="1.3._Windows_Event_Logs.html">1.3 Windows Event Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="1.4_Find_the_Next_Objective.html">1.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="1.5_Suricata_Regatta.html">1.5 Suricata_Regatta</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">2. Recover the Elfen Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.1_Clone_with_a_Diference.html">2.1 Clone with a Diference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.2_Find_the_Next_Objective.html">2.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.3_Prison_Escape.html">2.3 Prison Escape</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.4_Find_the_Next_Objective.html">2.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.5_Jolly_CI_CD.html">2.5 Jolly CI/CD</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">3. Recover the Web Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.1_Naughty_IP.html">3.1 Naught IP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.2_Credential_Mining.html">3.2 Credential Mining</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.3_404_FTW.html">3.3 404 FTW</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.4_IMDS_XXE_and_Other_Abbreviations.html">3.4 IMDS XXE and Other Abbreviations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.5_Find_the_Next_Objective.html">3.5 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.6_Open_Boria_Mine_Door.html">3.6 Open Boria Mine Door</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.7_Find_the_Next_Objective.html">3.7 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.8_Glamtariel_s_Fountain.html">3.8 Glamtariel's Fountain</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">4. Recover the Cloud Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../4_Recover_the_Cloud_Ring/4.1_AWS_CLI_Intro.html">4.1 AWS CLI_Intro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_Recover_the_Cloud_Ring/4.2_Find_the_Next_Objective.html">4.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_Recover_the_Cloud_Ring/4.3_Trufflehog_Search.html">4.3 Trufflehog Search</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_Recover_the_Cloud_Ring/4.4_Find_the_Next_Objective.html">4.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_Recover_the_Cloud_Ring/4.5_Exploitation_via_AWS_CLI.html">4.5 Exploitation via AWS CLI</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">5. Recover the Burning Ring of Fire</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.1_Buy_a_Hat.html">5.1 Buy a Hat</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.2_Blockchain_Divination.html">5.2 Blockchain Divination</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.3_Exploit_a_Smart_Contract.html">5.3 Exploit a Smart Contract</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">6. Finale</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../6_Finale/6.1_Finale.html">6.1 Finale and Roll Credits</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">alt3kx KringleCon 2022 Write-Up</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html" class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>1. Recover the Tolkien Ring &raquo;</li>
      <li>1.1 Wireshark Practice</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="recover-the-tolkien-ring">Recover the Tolkien Ring</h1>
<h2 id="11-wireshark-practice">1.1 Wireshark Practice</h2>
<p><img src="img/1.1_Wireshark_Practice.png"></p>
<p>Use the Wireshark Phishing terminal in the Tolkien Ring to solve the mysteries around the suspicious PCAP. Get hints for this challenge by typing hint in the upper panel of the terminal.</p>
<p><img src="img/1.1_Sparkle_Redberry.png"></p>
<h2 id="solve">Solve</h2>
<p>Download the pcap file: https://storage.googleapis.com/hhc22_player_assets/suspicious.pcap</p>
<h3 id="terminal-answers">Terminal answers</h3>
<p>Task: Analyze the Wireshark file and Answer the Elf's Questions!
To complete your task, download the file from your badge or use this command line to answer the questions.
Tips:
1. Each question may have hints. If you want another hint from the elf, just type hint in the upper pane.
2. If you need help with Wireshark filters you can go here: https://wiki.wireshark.org/DisplayFilters
3. If you need help with tshark filters, try this cheat sheet: https://cheatography.com/mbwalker/cheat-sheets/tshark-wireshark-command-line/ 
4. Of course, SANS has lots of cheat sheets that can help: https://www.sans.org/blog/the-ultimate-list-of-sans-cheat-sheets/
5. And remember, you can use Wireshark filters in tshark.</p>
<p>Tmux orientation:
For this terminal, you can use the mouse to switch or resize panes.
For clipboard use, you can shift-click and drag, then Ctrl+c to copy.
Use Ctrl+Shift+v to paste.
Normal tmux shortcuts ( Ctrl+b+↑ or ↓ ) work as well.</p>
<p>1.- There are objects in the PCAP file that can be exported by Wireshark and/or Tshark. What type of objects can be exeported from this PCAP?</p>
<pre><code class="language-ruby">ANSWER: http
</code></pre>
<p>Solve: Just read the links and hints and info provided </br>
<strong>Hint 1</strong>: https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/</br>
<strong>Hint 2</strong>: We're looking for a protocol like FTP, HTTP, SMB, etc.</br>
<strong>Hint 3</strong>: https://osqa-ask.wireshark.org/questions/35846/how-can-i-export-http-objects-via-command-line/</br></p>
<p>2.- What is the file name of the largest file we can export?</p>
<pre><code class="language-ruby">ANSWER: app.php
</code></pre>
<p>Solve: Use tshark commandliner <code>$ tshark -r pcap_challenge.pcap --export-objects "http,http"</code></br>
<strong>Hint 1</strong>: https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/</br>
<strong>Hint 2</strong>: If working in the terminal, you may need to combine tshark commands with other Linux commands</br></p>
<p>3.- What packet number starts the app.php file?</p>
<pre><code class="language-ruby">ANSWER: 687
</code></pre>
<p>Solve:  Use wireshark:  <code>Export HTTP options -&gt; see the number of packets [../snip]</code></br>
<strong>Hint 1</strong>: In Wireshark, the Export | HTTP object list shows start packet numbers</br>
<strong>Hint 2</strong>: When using tshark look for (text/html) in the output</br></p>
<p>4.- What is the IP pf the Apache Server?</p>
<pre><code class="language-ruby">ANSWER: 192.185.57.242
</code></pre>
<p>Solve: <code>Just use wireshark to visualize the IP address with Apache Server</code></br>
<strong>Hint 1</strong>: Search for 'apache' with Wireshark's Find function</br>
<strong>Hint 2</strong>: Remember Linux is case-sensitive</br>
<strong>Hint 3</strong>: Try using http.request and http.host </br></p>
<p>5.- What file is saved to the infected hosts?</p>
<pre><code class="language-ruby">ANSWER: Ref_Sept24-2020.zip
</code></pre>
<p>Solve: <code>See inside app(1).php, data is encoded</code> </br>
<strong>Hint 1</strong>: Look inside the first TCP stream </br>
<strong>Hint 2</strong>: The answer is a .zip file </br>
<strong>Hint 3</strong>: Look inside the files that you exported using tshark </br>
<strong>Hint 4</strong>: https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/ </br></p>
<p>6.- Attackers used bad TLS certificates in this traffict. Which countries were thet registered to6? Submit the names of the countries in alphabetical order separated by a commas Ex: Norway, South Korea).</p>
<pre><code class="language-ruby">ANSWER: Ireland, Israel, South Sudan , United States
</code></pre>
<p>Solve: Use tshark commandliner <code>$ tshark -r suspicious.pcap -Y "ssl.handshake.type == 11"</code> &lt;- or better using wireshark and see the options on Certificate Section: </br>
<strong>Hint 1</strong>: Look up the country code </br>
<strong>Hint 2</strong>: Look for cookies in https </br>
<strong>Hint 3</strong>: Filter for tls handshake for certificate, https://subscription.packtpub.com/book/networking-and-servers/9781785887819/4/ch04lvl1sec27/the-ssl-tls-handshake </br>
<strong>Hint 4</strong>: When using tshark, pipe results to grep, awk, sort, or any other tools that can help filter through the data</br></p>
<pre><code class="language-ruby">SS (South Sudan), US (United States), IL (Israel), IE (Ireland)
</code></pre>
<p><img src="img/6_answer.png"> </br></p>
<p>7.- Is the host infected? </p>
<pre><code class="language-ruby">ANSWER: yes
</code></pre>
<p><img src="img/1.1_Wireshark_Practice_completed.png"></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../0_KringleCon_Orientation/05_Talk_to_Santa.html" class="btn btn-neutral float-left" title="05. Talk to Santa"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="1.2_Find_the_Next_Objective.html" class="btn btn-neutral float-right" title="1.2 Find the Next Objective">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../0_KringleCon_Orientation/05_Talk_to_Santa.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="1.2_Find_the_Next_Objective.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../js/print-site.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
